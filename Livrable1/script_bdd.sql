-- Generated by Oracle SQL Developer Data Modeler 23.1.0.087.0806
--   at:        2024-05-25 01:35:07 HAE
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g



-- predefined type, no DDL - MDSYS.SDO_GEOMETRY

-- predefined type, no DDL - XMLTYPE

/* 
Si les tables existent déjà, utiliser le code ci-dessous afin de les supprimer.
DROP TABLE facture;
DROP TABLE produit;
DROP TABLE panier;
DROP TABLE client;
DROP TABLE magasin;
*/


CREATE TABLE client (
    id_client          NUMBER NOT NULL,
    nom                VARCHAR2(50) NOT NULL,
    prenom             VARCHAR2(50) NOT NULL,
    adresse            VARCHAR2(200) NOT NULL,
    numero_telephone   VARCHAR2(12) NOT NULL,
    nom_utilisateur    VARCHAR2(50) NOT NULL,
    mot_de_passe       VARCHAR2(100) NOT NULL,
    magasin_id_magasin NUMBER NOT NULL
);

ALTER TABLE client ADD CONSTRAINT client_pk PRIMARY KEY ( id_client );

CREATE TABLE facture (
    id_achat         NUMBER NOT NULL,
    prix_total       NUMBER NOT NULL,
    date_achat       DATE NOT NULL,
    panier_id_panier NUMBER NOT NULL
);

CREATE UNIQUE INDEX facture__idx ON
    facture (
        panier_id_panier
    ASC );

ALTER TABLE facture ADD CONSTRAINT facture_pk PRIMARY KEY ( id_achat );

CREATE TABLE magasin (
    id_magasin        NUMBER NOT NULL,
    nom_magasin       VARCHAR2(50) NOT NULL,
    adresse           VARCHAR2(200) NOT NULL,
    numero_telephone  VARCHAR2(12) NOT NULL,
    horaire_ouverture VARCHAR2(100) NOT NULL
);

ALTER TABLE magasin ADD CONSTRAINT magasin_pk PRIMARY KEY ( id_magasin );

CREATE TABLE panier (
    id_panier        NUMBER NOT NULL,
    nombre_produits  NUMBER NOT NULL,
    client_id_client NUMBER NOT NULL
);

CREATE UNIQUE INDEX panier__idx ON
    panier (
        client_id_client
    ASC );

ALTER TABLE panier ADD CONSTRAINT panier_pk PRIMARY KEY ( id_panier );

CREATE TABLE produit (
    id_produit         NUMBER NOT NULL,
    chemin_image       VARCHAR2(50) NOT NULL,
    nom_produit        VARCHAR2(100) NOT NULL,
    description        VARCHAR2(100) NOT NULL,
    prix               NUMBER NOT NULL,
    quantite           NUMBER NOT NULL,
    panier_id_panier   NUMBER,
    magasin_id_magasin NUMBER NOT NULL
);

ALTER TABLE produit ADD CONSTRAINT produit_pk PRIMARY KEY ( id_produit );

ALTER TABLE client
    ADD CONSTRAINT client_magasin_fk FOREIGN KEY ( magasin_id_magasin )
        REFERENCES magasin ( id_magasin );

ALTER TABLE facture
    ADD CONSTRAINT facture_panier_fk FOREIGN KEY ( panier_id_panier )
        REFERENCES panier ( id_panier );

ALTER TABLE panier
    ADD CONSTRAINT panier_client_fk FOREIGN KEY ( client_id_client )
        REFERENCES client ( id_client );

ALTER TABLE produit
    ADD CONSTRAINT produit_magasin_fk FOREIGN KEY ( magasin_id_magasin )
        REFERENCES magasin ( id_magasin );

ALTER TABLE produit
    ADD CONSTRAINT produit_panier_fk FOREIGN KEY ( panier_id_panier )
        REFERENCES panier ( id_panier );



-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                             5
-- CREATE INDEX                             2
-- ALTER TABLE                             10
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0








-- Insertion de magasins dans la table "magasin".
INSERT INTO magasin (id_magasin, nom_magasin, adresse, numero_telephone, horaire_ouverture)
VALUES (1, 'Ludo Montréal', '4783 rue Le Corbusier, Montréal (Québec)', '514-247-8467', 'Lundi au vendredi: 8h à 20h, Samedi et dimanche: 8h à 17h');
INSERT INTO magasin (id_magasin, nom_magasin, adresse, numero_telephone, horaire_ouverture)
VALUES (2, 'Ludo laval', '12588 rue Hôtel, Laval (Québec)', '514-587-5987', 'Lundi au vendredi: 8h à 19h, Samedi et dimanche: 8h à 17h');
INSERT INTO magasin (id_magasin, nom_magasin, adresse, numero_telephone, horaire_ouverture)
VALUES (3, 'Ludo Toronto', '87569 boulevard Bremner, Toronto (Ontario)', '438-284-8246', 'Lundi au vendredi: 8h à 22h, Samedi et dimanche: 8h à 17h'); 




-- Insertion de client dans la table "client".

-- Insertion des clients du magasin id 1.
INSERT INTO client (id_client, nom, prenom, adresse, numero_telephone, nom_utilisateur, mot_de_passe, magasin_id_magasin)
VALUES (1, 'Ait benhammou', 'Mohamed','4596 Duke Street, Montreal QC H3C 5K4', '514-581-5941', 'Mohamed@gmail.com', 'jspassword', 1);
INSERT INTO client (id_client, nom, prenom, adresse, numero_telephone, nom_utilisateur, mot_de_passe, magasin_id_magasin)
VALUES (2, 'Abram', 'Fields','2422 Central Pkwy, Mississauga ON L5L 5S1', '514-587-2671', 'Abram@gmail.com', 'Abrammotdepasse', 1);
INSERT INTO client (id_client, nom, prenom, adresse, numero_telephone, nom_utilisateur, mot_de_passe, magasin_id_magasin)
VALUES (3, 'Ellen', 'House','4596 Duke Street, Montreal QC H3C 5K4', '514-854-6827', 'Ellen@gmail.com', 'Ellenbmotdepasse', 1);
INSERT INTO client (id_client, nom, prenom, adresse, numero_telephone, nom_utilisateur, mot_de_passe, magasin_id_magasin)
VALUES (4, 'Laurel', 'Chang','1306 Merivale Road, Kanata ON K2K 1L9', '514-871-3179', 'Chang@gmail.com', 'Changpassword', 1);
INSERT INTO client (id_client, nom, prenom, adresse, numero_telephone, nom_utilisateur, mot_de_passe, magasin_id_magasin)
VALUES (5, 'Paxton', 'English','3970 Bloor Street, Ardrossan AB T0B 0E0', '514-892-6817', 'Paxtion@gmail.com', 'Paxtonpassword', 1);
INSERT INTO client (id_client, nom, prenom, adresse, numero_telephone, nom_utilisateur, mot_de_passe, magasin_id_magasin)

-- Insertion des clients du magasin id 2.
VALUES (6, 'Agnes', 'Cochrane','969 Brand Road, Saskatoon SK S7K 1W8', '514-887-6857', 'Agnes@gmail.com', 'gPG3v0E23c', 2);
INSERT INTO client (id_client, nom, prenom, adresse, numero_telephone, nom_utilisateur, mot_de_passe, magasin_id_magasin)
VALUES (7, 'Christine', 'Watt','4798 René-Lévesque Blvd, Montreal QC H3B 4W8', '514-685-8276', 'Christine@gmail.com', 'iX8FpwXqP2', 2);
INSERT INTO client (id_client, nom, prenom, adresse, numero_telephone, nom_utilisateur, mot_de_passe, magasin_id_magasin)

-- Insertion des clients du magasin id 3.
VALUES (8, 'Martin', 'Roy','2124 Adelaide St, Toronto ON M5H 1P6', '514-257-3589', 'Martin@gmail.com', 'ui07fmxyRh', 3);
INSERT INTO client (id_client, nom, prenom, adresse, numero_telephone, nom_utilisateur, mot_de_passe, magasin_id_magasin)
VALUES (9, 'Johnson', 'Lee','1145 Montreal Road, Ottawa ON K1L 6C7', '514-987-6782', 'Johnson@gmail.com', '6jKR0HQA34', 3);
INSERT INTO client (id_client, nom, prenom, adresse, numero_telephone, nom_utilisateur, mot_de_passe, magasin_id_magasin)
VALUES (10, 'Wilson', 'Wright','1163 Weir Crescent, Toronto ON M1E 3T8', '438-955-4681', 'Wilson@gmail.com', 'jZJneXJ22V', 3);






-- Insertion de paniers dans la tablie "panier".

-- Insertion des paniers des clients du magasin id 1.
INSERT INTO panier (id_panier, nombre_produits, client_id_client) 
VALUES (1, 2, 1);
INSERT INTO panier (id_panier, nombre_produits, client_id_client) 
VALUES (2, 1, 2);
INSERT INTO panier (id_panier, nombre_produits, client_id_client) 
VALUES (3, 2, 3);
INSERT INTO panier (id_panier, nombre_produits, client_id_client) 
VALUES (4, 0, 4);
INSERT INTO panier (id_panier, nombre_produits, client_id_client) 
VALUES (5, 1, 5);

-- Insertion des paniers des clients du magasin id 2.
INSERT INTO panier (id_panier, nombre_produits, client_id_client) 
VALUES (6, 2, 6);
INSERT INTO panier (id_panier, nombre_produits, client_id_client) 
VALUES (7, 2, 7);

-- Insertion des paniers des clients du magasin id 3.
INSERT INTO panier (id_panier, nombre_produits, client_id_client) 
VALUES (8, 1, 8);
INSERT INTO panier (id_panier, nombre_produits, client_id_client) 
VALUES (9, 1, 9);
INSERT INTO panier (id_panier, nombre_produits, client_id_client) 
VALUES (10, 4, 10);





-- Insertion de produits dans la table "produit". 

-- Insertion des produit du magasin id 1.
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (1, 'laptop1-magasin1.jpg', 'MacBook Pro de 14 po d''Apple (2023)',  'Processeur M2 Pro d''Apple, stockage de 512 Go et mémoire RAM de 16 Go', 2600, 10, 1, 1);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (2, 'laptop2-magasin1.jpg','Portable 15,6 po VivoBook 15 d''ASUS - Bleu calme', 'Processeur Ryzen 7 5800H d''AMD, stockage de 512 Go SSD, mémoire RAM de 16 Go et Windows 11', 650, 5, 1, 1);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (3, 'laptop3-magasin1.jpg','Portable de 17,3 po série Pulse de MSI - Gris titane', 'Processeur Core i9-13900H d''Intel, stockage de 1 To SSD, mémoire RAM de 16 Go et GeForce RTX 4070', 2100, 2, 2, 1);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (4, 'laptop4-magasin1.jpg','Portable Galaxy Book4 de 15,6 po de Samsung - Gris', 'Processeur Core 7-150U d''Intel, stockage de 512 Go SSD, mémoire RAM de 16 Go et Windows 11', 1000, 8, 3, 1);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (5, 'laptop5-magasin1.jpg','MacBook Air de 13,6 po avec Touch ID d''Apple (2022) - Minuit', 'Processeur puce M2 d''Apple, stockage de 256 Go SSD et mémoire RAM de 8 Go', 1200, 9, 3, 1);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (6, 'laptop6-magasin1.jpg','Portable à écran tactile DELO de 14 po ZenBook 14 d''ASUS - Bleu', 'Processeur Core Ultra 7 155H d''Intel, stockage de 1 To SSD, mémoire RAM de 16 Go et Windows 11', 1600, 10, 5, 1);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)

-- Insertion des produits du magasin id 2.
VALUES (7, 'laptop7-magasin2.jpg','Portable IdeaPad Slim 3i de 15,6 po de Lenovo - Gris arctique', 'Processeur Core i7-1355U Intel, stockage de 512 Go SSD, mémoire RAM de 16 Go et Windows 11', 1200, 5, 6, 2);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (8, 'laptop8-magasin2.jpg','Portable ExpertBook B1 15,6 po d’ASUS-Noir étoile', 'Processeur Core i7 1255U d’Intel, stockage de 512 Go SSD, mémoire RAM de 16 Go et Windows 11', 1600, 10, 6, 2);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (9, 'laptop9-magasin2.jpg','Portable DELO de 15,6 po VivoBook Pro d''ASUS - Bleu calme', 'Processeur Ryzen 7 5800H d''AMD, stockage de 512 Go SSD, mémoire RAM de 16 Go et GeForce RTX 3050', 1500, 8, 7, 2);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (10, 'laptop10-magasin2.jpg','MacBook Pro de 14 po d''Apple (2023) - Argenté', 'Processeur M2 Pro d''Apple, stockage de 512 Go SSD et mémoire RAM de 16 Go', 2600, 10, 7, 2);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (11, 'laptop11-magasin2.jpg','Portable IdeaPad Slim 3i de 15,6 po de Lenovo - Gris arctique', 'Processeur Core i7-1355U Intel, stockage de 512 Go SSD, mémoire RAM de 16 Go et Windows 11', 1200, 20, null, 2);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (12, 'laptop12-magasin2.jpg','Surface Laptop 5 à écran tactile de 13,5 po de Microsoft - Noir', 'Processeur Evo i5-1235U d''Intel, stockage de 512 Go SSD, mémoire RAM de 8 Go et Windows 11', 1500, 18, null, 2);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)

-- Insertion des produits du magasin id 3.
VALUES (13, 'laptop13-magasin3.jpg','Portable ExpertBook B1 15,6 po d’ASUS-Noir étoile', 'Processeur Core i7 1255U d’Intel, stockage de 512 Go SSD, mémoire RAM de 16 Go et Windows 11', 1600, 10, 8, 3);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (14, 'laptop14-magasin3.jpg', 'Portable Surface Laptop Go 3 de 12,45 po Microsoft - Grès',  'Processeur i5-1235U d''Intel, stockage de 256 Go SSD et mémoire RAM de 8 Go', 1100, 22, 9, 3);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (15, 'laptop15-magasin3.jpg','Portable 15,6 po VivoBook 15 d''ASUS - Bleu calme', 'Processeur Ryzen 7 5800H d''AMD, stockage de 512 Go SSD, mémoire RAM de 16 Go et Windows 11', 650, 5, 10, 3);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (16, 'laptop16-magasin3.jpg','Portable de 17,3 po série Pulse de MSI - Gris titane', 'Processeur Core i9-13900H d''Intel, stockage de 1 To SSD, mémoire RAM de 16 Go et GeForce RTX 4070', 2100, 2, 10, 3);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (17, 'laptop17-magasin3.jpg','Portable Galaxy Book4 de 15,6 po de Samsung - Gris', 'Processeur Core 7-150U d''Intel, stockage de 512 Go SSD, mémoire RAM de 16 Go et Windows 11', 1000, 8, 10, 3);
INSERT INTO produit (id_produit, chemin_image, nom_produit, description, prix, quantite, panier_id_panier, magasin_id_magasin)
VALUES (18, 'laptop18-magasin3.jpg','MacBook Air 13,6 po + Touch ID d''Apple (2022) - Bleu minuit', 'Processeur puce M2 d''Apple, stockage de 512 Go SSD et mémoire RAM de 8 Go', 1550, 25, 10, 3);




-- Insertion des factures dans la table "facture".

-- Insertion de la facture du client id 1.
INSERT INTO facture (id_achat, prix_total, date_achat, panier_id_panier)
VALUES (1, 3250, '24-MAY-24', 1);

-- Insertion de la facture du client id 2.
INSERT INTO facture (id_achat, prix_total, date_achat, panier_id_panier)
VALUES (2, 3000, '24-MAY-24', 2);

-- Insertion de la facture du client id 3.
INSERT INTO facture (id_achat, prix_total, date_achat, panier_id_panier)
VALUES (3, 2850, '28-MAY-24', 3);

-- Insertion de la facture du client id 4.
INSERT INTO facture (id_achat, prix_total, date_achat, panier_id_panier)
VALUES (4, 2500, '25-MAY-24', 4);

-- Insertion de la facture du client id 5.
INSERT INTO facture (id_achat, prix_total, date_achat, panier_id_panier)
VALUES (5, 1600, '18-MAY-24', 5);

-- Insertion de la facture du client id 6.
INSERT INTO facture (id_achat, prix_total, date_achat, panier_id_panier)
VALUES (6, 2950, '29-MAY-24', 6);

-- Insertion de la facture du client id 7.
INSERT INTO facture (id_achat, prix_total, date_achat, panier_id_panier)
VALUES (7, 3500, '30-MAY-24', 7);

-- Insertion de la facture du client id 8.
INSERT INTO facture (id_achat, prix_total, date_achat, panier_id_panier)
VALUES (8, 1800, '21-MAY-24', 8);

-- Insertion de la facture du client id 9.
INSERT INTO facture (id_achat, prix_total, date_achat, panier_id_panier)
VALUES (9, 2000, '30-MAY-24', 9);

-- Insertion de la facture du client id 10.
INSERT INTO facture (id_achat, prix_total, date_achat, panier_id_panier)
VALUES (10, 5300, '28-MAY-24', 10);






-- ceci va crer un URI sous le URL qui pourra etre utilise pour y activer les tables en mode REST
BEGIN
  ORDS.enable_schema(
    p_enabled             => TRUE,
    p_schema              => 'RESTSCOTT',
    p_url_mapping_type    => 'BASE_PATH',
    p_url_mapping_pattern => 'TP3',
    p_auto_rest_auth      => FALSE
  );
    
  COMMIT;
END;
/


BEGIN

    ORDS.ENABLE_OBJECT(p_enabled => TRUE,
                       p_schema => 'RESTSCOTT',
                       p_object => 'MAGASIN',
                       p_object_type => 'TABLE',
                       p_object_alias => 'magasin');
    commit;

END;
/

BEGIN

    ORDS.ENABLE_OBJECT(p_enabled => TRUE,
                       p_schema => 'RESTSCOTT',
                       p_object => 'CLIENT',
                       p_object_type => 'TABLE',
                       p_object_alias => 'client');
    commit;

END;
/




BEGIN

    ORDS.ENABLE_OBJECT(p_enabled => TRUE,
                       p_schema => 'RESTSCOTT',
                       p_object => 'FACTURE',
                       p_object_type => 'TABLE',
                       p_object_alias => 'facture');
    commit;

END;
/


BEGIN

    ORDS.ENABLE_OBJECT(p_enabled => TRUE,
                       p_schema => 'RESTSCOTT',
                       p_object => 'PANIER',
                       p_object_type => 'TABLE',
                       p_object_alias => 'panier'
                       );
    commit;

END;
/

BEGIN

    ORDS.ENABLE_OBJECT(p_enabled => TRUE,
                       p_schema => 'RESTSCOTT',
                       p_object => 'PRODUIT',
                       p_object_type => 'TABLE',
                       p_object_alias => 'produit');
    commit;

END;
/
-- confirmation de l'Activation du schema
SELECT *
FROM user_ords_schemas;

-- confirmation de l'activation de la table emp pour REST
SELECT *
FROM   user_ords_enabled_objects;






